---
title: "MH3511_Project"
output: 
  html_document:
    fig_caption: yes
    toc: yes
    toc_depth: 3
    toc_float: yes
---

```{r}
data = read.csv("C:\\Users\\victo\\Downloads\\Insurance_data\\insurance_data.csv", header = T)
head(data)
```

```{r}
colSums(is.na(data) | data == "")
```

From the above results, there is 5 missing values for age and 3 missing values for region and so we decide to remove the rows with missing values

```{r}
data = data[!(rowSums(is.na(data) | data == "") > 0), ]
```

```{r}
# Check that rows with empty values are removed
colSums(is.na(data) | data == "")
```

```{r}
# index column is dropped
data = data[,2:11]
head(data)
```

```{r}
dim(data)
```

## Description and Cleaning of Dataset

```{r}
# summary statistics for the main variable of interest, claim
x1 = seq(0, max(data$claim), 0.1)
y1 = dnorm(x1, mean=mean(data$claim), sd=sd(data$claim))*5000*length(data$claim)
boxplot((data$claim))
hist(data$claim, main = "Histogram of claim", xlab = "claim")
lines(x1,y1, col='red')

```

```{r}
boxplot(log(data$claim), main = "Boxplot of log(claim)")
x2 = seq(min(log(data$claim)), max(log(data$claim))+0.5, 0.1)
y2 = dnorm(x2, mean=mean(log(data$claim)), sd=sd(log(data$claim)))*0.5*length(log(data$claim))
hist(log(data$claim), main = "Histogram of log(claim)", xlab = "claim") # log-transformation
lines(x2, y2, col='blue')

```

```{r}
par(mfrow=c(1,2))
qqnorm(data$claim)
qqline(data$claim, col='red')

qqnorm(log(data$claim))
qqline(log(data$claim), col='red')
```

```{r}
library(moments)
print(skewness(data$claim))
print(skewness(log(data$claim)))
```

```{r}
summary(log(data$claim))
```

```{r}
par(mfrow = c(1,2))
hist(data$age)
boxplot(data$age)
```

```{r}
par(mfrow = c(1,2))
hist(data$bmi)
boxplot(data$bmi)
```

```{r}
par(mfrow = c(1,2))
hist(data$bloodpressure)
boxplot(data$bloodpressure)
```

## Statistical Analysis

```{r}
library(gplots)
mat = cor(data[,c(2, 4, 5, 10)])
heatmap.2(mat, cellnote=round(mat, 2), trace = "none", notecol="black")
```

```{r}
pairs(data[,c(2, 4, 5, 10)])
```

Relation between claims and gender

```{r}
boxplot(log(data$claim)~data$gender)
```

Relation between claims and diabetic

```{r}
boxplot(log(data$claim)~data$diabetic)
```

Relation between claim and children

```{r}
boxplot(log(data$claim)~data$children)
```

Relation between claim and smoker

```{r}
boxplot(log(data$claim)~data$smoker)
```

Relation between claim and region

```{r}
boxplot(log(data$claim)~data$region)
```
